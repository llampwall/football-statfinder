### CODEX RULES  ###
- *DO NOT EDIT THIS FILE UNLESS SPECIFICALLY INSTRUCTED*

## SURGICAL PATCH PROTOCOL (MANDATORY)

Change limits:
- DO NOT rewrite files top-to-bottom. Touch only the specific functions/blocks needed.
- Max N lines changed per file: 200 (additions + deletions). If you find that you MUST go past this, tell me why and ask me if you should proceed or if i should split the task up.
- Max files changed per task: 3 unless explicitly allowed in the prompt.
- Max scope: avoid refactors. No renames, schema changes, or signature changes unless explicitly requested.

Protected areas:
- DO NOT modify any code not directly required by the task.
- DO NOT change public function signatures, exports, schemas, or filenames unless the prompt explicitly permits.
- DO NOT touch files listed under “Do-Not-Touch” in this repo.

Behavioral guardrails:
- Preserve existing behavior by default. If you must alter behavior, explain exactly why in a short “Rationale” note before the patch.
- Maintain all acceptance checks, console diagnostics, and schemas.
- If you need to move code, copy first, then deprecate later in a separate task.

Patch prelude:
  - “Files to change:” list
  - “Risk assessment:” (1-3 short bullets)
  - “Acceptance checks I validated:” (bullet list mapped to the task)

Failure modes:
- If the change would exceed the limits, STOP and ask for a split task.
- If you’re unsure about an edge case, STOP and propose two minimal options.

When in doubt
- If a change would balloon (e.g., >200 lines across all files), stop and propose how to split it.
- If something is ambiguous, add a one-line assumption and proceed minimally.

## Documentation Standards (MANDATORY)

**When this applies:** Every task that adds or edits Python/JS files. This is not a separate docs pass — do it as you code.

**Module header (top of every new/edited file):**
- Purpose & scope (league if applicable).
- Spec anchor(s) relevant to the change.
- Invariants (UTC, boundaries, append-only, atomic writes, etc.).
- Side effects (files written/paths), and “Do not” guardrails.
- Log contract (exact one-line format if the file emits logs).

**Function docstrings (Google style):**
- All public functions and any non-trivial helpers.
- Include Args / Returns / Raises / Notes (UTC/time rules, idempotency).

**Comment blocks (“WHY THIS EXISTS”):**
- Precede any non-obvious heuristic (e.g., odds pin role-swap, neutral-site rules).
- Keep it short and precise.

**Spec anchors required:**
- If the work relates to week computation, provider decoupling, odds, ratings, scores, or ATS, include:
  - `/context/global_week_and_provider_decoupling.md` in the module header.
- If using league normalization, include:
  - `src/common/team_names_<league>.py` as a dependency note.


**RUN/EVIDENCE POLICY**

- NEVER claim a command was run unless you executed it in the terminal.
- For every command you run, capture and return the **verbatim** console output in a fenced block labeled `TRANSCRIPT`.
- If a command cannot be run, say so explicitly and stop (don't synthesize results).
- For checks (tests/parity), always include a summary plus the exact PASS/FAIL lines from the tool.

**API ERROR HANDLING (MANDATORY)**

- Surface every HTTP error code and message immediately in the console using RED text (ANSI 91) and mirror the payload in relevant debug artifacts.
- When integrating a new API call, include a minimal “hello world” / smoke invocation in acceptance to prove the request path works before deeper wiring.

**NOTIFY POLICY**

- Discord notification handled externally via config.toml hook.
- Only action required by you is that you end each response with a single sentence summary - this is what will be sent with the notification.
